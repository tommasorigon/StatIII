---
title: "Generalized Linear Models"
subtitle: "Statistics III - CdL SSE"
author: "[Tommaso Rigon]{.orange}"
institute: "_Universit√† degli Studi di Milano-Bicocca_"
page-layout: full
bibliography: ../biblio.bib
citeproc: true
csl: https://www.zotero.org/styles/journal-of-the-american-statistical-association
reference-location: margin
execute:
  cache: false
filters: 
  - remove-pause.lua
format:
  revealjs:
    auto-stretch: true
    center: true
    html-math-method: katex
    transition: none
    output-file: un_B_slides.html
    slide-number: true
    callout-appearance: minimal
    code-line-numbers: true
    theme: [default, ../template.css] # alternative themes (subset): default, night, dark
    embed-resources: false
    echo: false
    fig-dpi: 250
    # incremental: true  # Remove comment if you like incremental bullet points
    logo: img/logoB.png
    footer: "[Home page](https://tommasorigon.github.io/StatIII)"
  html:
    html-math-method: katex
    echo: false
    callout-appearance: minimal
    theme: [simplex, ../template.css]
    toc: true
    toc-title: Table of contents
    embed-resources: false
    smooth-scroll: true
    fig-dpi: 250
editor: 
  markdown: 
    wrap: 72
editor_options: 
  chunk_output_type: console
---

## [Homepage](../index.html)

```{r}
#| warning: false
#| echo: false
#| include: false
#| message: false
#| purl: false

knitr::purl("un_B.qmd", output = "../code/un_B.R", documentation = 0)
styler:::style_file("../code/un_B.R")

library(ggplot2)
library(ggthemes)
library(MLGdata)
```

::: columns
::: {.column width="30%"}
![](img/gaussian.png)
:::

::: {.column width="70%"}
- This unit will cover the following [topics]{.orange}:
    - Exponential dispersion families
    - Likelihood, inference and testing
    - Iteratively Re-weighted Least Squares (IRLS)
    - Deviance, model checking, and residuals
    - Model selection
    
- GLMs are regression models with a linear predictor in which the response variable is distributed according to an [exponential dispersion family]{.blue}.

- This  Unit covers the [theoretical backbone]{.orange} of GLMs.
:::
:::

:::callout-tip
The content of this Unit is covered in [Chapter 2]{.orange} of @Salvan2020. Alternatively, see [Chapter 4]{.blue} of @Agresti2015 or [Chapter 6]{.grey} of @Azzalini2008.
:::

# Introduction

## Preliminaries

- GLMs are a class of [regression models]{.blue} where we describe a [response]{.orange} random variable $Y_i$ as a function of a vector of [covariates]{.grey} $\bm{x}_i \in \mathbb{R}^p$.  

- The random variables $Y_i$ are not restricted to be Gaussian. For example, we may have  
  - $Y_i \in \{0,1\}$, often called [binary regression]{.blue}  
  - $Y_i \in \{0,1,\dots\}$, often called [count regression]{.orange}  
  - $Y_i \in (0,\infty)$ or $Y_i \in (-\infty,\infty)$  

- Gaussian linear models form a special case of GLMs, arising when  $Y_i \in (-\infty,\infty)$

. . .

- The [response random variables]{.orange} are collected in the random vector $\bm{Y} = (Y_1,\dots,Y_n)^T$, whose [observed realization]{.blue} is $\bm{y} = (y_1,\dots,y_n)^T$.

- The [design matrix]{.blue} $\bm{X}$ is a $n \times p$ matrix, comprising the covariate's values. The $j$th variable (column) is denoted with $\tilde{\bm{x}}_j$, whereas the $i$th observation (row) is $\bm{x}_i$.

## `Beetles` data, from Bliss (1935) 

- The `Beetles` dataset originates from Bliss (1935). It records the number of adult flour beetles that died after a 5-hour exposure to gaseous carbon disulphide.

```{r}
data("Beetles")
colnames(Beetles) <- c("n", "deaths", "logdose")
knitr::kable(Beetles)
```

- We aim to predict the proportion of `deaths` as a function of the `logdose`.

- Modelling death proportions directly with [linear models]{.orange} is [inappropriate]{.orange}. While a [variance-stabilizing]{.blue} transformation offers a more [principled]{.blue} approach, it has important [drawbacks]{.orange}.

## `Beetles` data, a dose-response plot

```{r}
#| fig-width: 7.8
#| fig-height: 4.55
#| fig-align: center
ggplot(data = Beetles, aes(x = logdose, y = deaths/n)) +
  geom_point() +
  theme_light() +
  theme(legend.position = "right") +
  scale_color_tableau(palette = "Color Blind") +
  xlab("log-dose") +
  ylab("Proportion of deaths")
```

- There is a clear [positive]{.orange} and [non-linear]{.blue} pattern between the [proportion of deaths]{.orange} as a function of the logdose.

## An attempt at modelling the `Beetles` data

- Let $Y_i$ the number of dead beetles out of $n_i$, and let $x_i$ be the log-dose. By definition, the random variables $Y_i \in \{0, 1, \dots, n_i\}$ for $i=1,\dots,8$. 

- It is reasonable to model each $Y_i$ as [independent binomial]{.blue} random variables, counting the number of deaths out of $n_i$ individuals. In other words:
$$
Y_i \overset{\text{ind}}{\sim} \text{Binomial}(n_i, \pi_i), \qquad i=1,\dots,8,
$$
where $\pi_i$ is the [probability]{.orange} of dying at a given dose. 

. . .

- Because of well-known properties of the binomial distribution, we know that
$$
\mathbb{E}(Y_i) = \mu_i = n_i \pi_i.
$$
We would like to express $\pi_i$, the proportion of deaths, as a function of $x_i$.

- A modelling possibility, called [logistic regression]{.blue} is the following:
$$
\pi_i = \frac{\exp(\beta_1 + \beta_2 x_i)}{1 + \exp(\beta_1 + \beta_2 x_i)}, \quad \text{ or equivalently} \quad \log\left(\frac{\pi_i}{1 - \pi_i}\right) = \beta_1 + \beta_2 x_i.
$$
for some parameters $\beta_1,\beta_2 \in \mathbb{R}$. Note that $\pi_i \in (0, 1)$ by construction. 


# Exponential dispersion families

## Overview

- Figure 1 of @Efron2023. [Three level]{.grey} of statistical modeling. 


![](img/EF.png){width=6in fig-align="center"}


- The [prime role]{.orange} of [exponential families]{.orange} in the theory of statistical inference was first emphasized by @Fisher1934.

- Most [well-known]{.blue} [distributions]{.blue}---such as Gaussian, Poisson, Binomial, and Gamma---are instances of exponential families.


# Generalized Linear Models

## References {.unnumbered}

::: {#refs}
:::
