---
title: "Binary and binomial regression"
subtitle: "Statistics III - CdL SSE"
author: "[Tommaso Rigon]{.orange}"
institute: "_Universit√† degli Studi di Milano-Bicocca_"
page-layout: full
bibliography: ../biblio.bib
citeproc: true
csl: https://www.zotero.org/styles/journal-of-the-american-statistical-association
reference-location: margin
execute:
  cache: false
filters: 
  - remove-pause.lua
format:
  revealjs:
    auto-stretch: true
    center: true
    html-math-method: katex
    transition: none
    output-file: un_C_slides.html
    slide-number: true
    callout-appearance: minimal
    code-line-numbers: true
    theme: [default, ../template.css] # alternative themes (subset): default, night, dark
    embed-resources: false
    echo: false
    fig-dpi: 250
    # incremental: true  # Remove comment if you like incremental bullet points
    logo: img/logoB.png
    footer: "[Home page](https://tommasorigon.github.io/StatIII)"
  html:
    html-math-method: katex
    echo: false
    callout-appearance: minimal
    theme: [simplex, ../template.css]
    toc: true
    execute: 
      message: false
      warning: false
    toc-title: Table of contents
    embed-resources: false
    smooth-scroll: true
    fig-dpi: 250
editor: 
  markdown: 
    wrap: 72
editor_options: 
  chunk_output_type: console
---

## [Homepage](../index.html)

```{r}
#| warning: false
#| echo: false
#| include: false
#| message: false
#| purl: false

knitr::purl("un_C.qmd", output = "../code/un_C.R", documentation = 0)
styler:::style_file("../code/un_C.R")

library(ggplot2)
library(ggthemes)
```

::: columns
::: {.column width="20%"}
![](img/challenger.png){width="100%"}

[Original paper](https://doi.org/10.2307/2290069)
<!-- *"Pluralitas non est ponenda sine necessitate."* -->

<!-- [William of Ockham]{.grey} -->
:::

::: {.column width="80%"}

- GLMs for [binary data]{.blue} and [binomial data]{.orange} are very common, whenever the response variable is dichotomous (e.g., success/failure, yes/no, dead/alive, diseased/healthy, etc.).

- This unit will cover a few additional topics related to binary and binomial regression, including:
  - grouped vs ungrouped data;
  - the choice of the link function;
  - interpretation of responses via latent "utilities";
  - and more...

- Clearly, the most important aspects have been already covered in [Unit B](un_.B.html).
:::

:::

:::callout-tip
The content of this Unit is covered in [Chapter 3]{.orange} of @Salvan2020. Alternatively, see [Chapter 5]{.blue} of @Agresti2015.
:::


## Notation and recap

- In a [binomial regression]{.blue} model, we observe $S_i$ [successes]{.blue} out of $m_i$ [trials]{.orange}
$$
S_i \overset{\text{ind}}{\sim} \text{Binomial}(m_i, \pi_i), \qquad g(\pi_i) = \eta_i = \bm{x}_i^T \beta, \qquad i=1,\dots,n.
$$
We model the proportions $Y_i = S_i / m_i$, whose mean is indeed $\pi_i$. 

- In a [binary regression]{.blue} model, we observe $Y_i \in \{0,1\}$, which is a special case of the model above with number of trials $m_i = 1$ for all $i$. Thus, we have
$$
Y_i \overset{\text{ind}}{\sim} \text{Bernoulli}(\pi_i), \qquad g(\pi_i) = \eta_i = \bm{x}_i^T \beta, \qquad i=1,\dots,n.
$$

:::callout-note
In this Unit, we distinguish between [two sample size measures]{.orange}:

  - a measure $m_i$ for the number of Bernoulli trials that constitute a particular binomial observation;
  - a measure $n$ for the number of binomial observations. 
:::

## Grouped vs ungrouped data

- If $Y_{ij} \in \{0,1\}$ are independent [Bernoulli]{.blue} random variables with success probability $\pi_i$, for $j=1,\dots, m_i$ and $i=1,\dots, n$, then
$$
S_i = \sum_{j=1}^{m_i} Y_{ij} \sim \text{Binomial}(m_i, \pi_i).
$$
- Thus, any binomial regression model can be [ungrouped]{.orange} into a binary regression model with $N = \sum_{i=1}^n m_i$ observations, by simply repeating the same response and covariate $m_i$ times. 

- On the other hand, a binary regression model can be [grouped]{.blue} only if multiple subjects share the same values for explanatory variables, which is common if they are all categorical. 

:::callout-note
The likelihood function of these two representation coincide up to a proportionality constant, which means that the maximum likelihood $\hat{\beta}$ and and the standard errors are identical.

However, the deviance and the residuals are different, which has implications for goodness-of-fit tests and model diagnostics. The diagnostics for binary data are typically uninformative.
:::

## Latent variable threshold models

- A latent variable threshold model is a useful way to interpret binary regression models and choosing their link function $g$. Let  $Y_i^*$ be a [latent]{.orange} and [continuous]{.orange} random variables such that
$$
Y_i^* = \bm{x}_i^T\beta + \epsilon_i, \qquad \epsilon_i \overset{\text{iid}}{\sim} F.
$$

- A variable is called latent because we do not observe it directly. Instead, we observe only a [binary variable]{.blue} encoding whether it exceeds a certain threshold, i.e.
$$
Y_i = \mathbb{I}(Y_i^* > \tau),
$$
where $\mathbb{I}(\cdot)$ is the indicator function and $\tau$ is a threshold.


## Link functions

## Logistic regression

## Comments on the residuals

## Overdispersion

## Goodness-of-fit test