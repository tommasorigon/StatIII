---
title: "Poisson regression"
subtitle: "Statistics III - CdL SSE"
author: "[Tommaso Rigon]{.orange}"
institute: "_Universit√† degli Studi di Milano-Bicocca_"
page-layout: full
bibliography: ../biblio.bib
citeproc: true
csl: https://www.zotero.org/styles/journal-of-the-american-statistical-association
reference-location: margin
execute:
  cache: false
filters: 
  - remove-pause.lua
format:
  revealjs:
    auto-stretch: true
    center: true
    html-math-method: katex
    transition: none
    output-file: un_D_slides.html
    slide-number: true
    callout-appearance: minimal
    code-line-numbers: true
    theme: [default, ../template.css] # alternative themes (subset): default, night, dark
    embed-resources: false
    echo: false
    fig-dpi: 250
    # incremental: true  # Remove comment if you like incremental bullet points
    logo: img/logoB.png
    footer: "[Home page](https://tommasorigon.github.io/StatIII)"
  html:
    html-math-method: katex
    echo: false
    callout-appearance: minimal
    theme: [simplex, ../template.css]
    toc: true
    execute: 
      message: false
      warning: false
    toc-title: Table of contents
    embed-resources: false
    smooth-scroll: true
    fig-dpi: 250
editor: 
  markdown: 
    wrap: 72
editor_options: 
  chunk_output_type: console
---

## [Homepage](../index.html)

```{r}
#| warning: false
#| echo: false
#| include: false
#| message: false
#| purl: false

knitr::purl("un_D.qmd", output = "../code/un_D.R", documentation = 0)
styler:::style_file("../code/un_D.R")

library(ggplot2)
library(ggthemes)
```

::: columns
::: {.column width="30%"}
![](img/agresti.jpg){width="100%"}

[Alan Agresti](https://en.wikipedia.org/wiki/Alan_Agresti)

Distinguished Professor Emeritus, University of Florida
<!-- *"Pluralitas non est ponenda sine necessitate."* -->

<!-- [William of Ockham]{.grey} -->
:::

::: {.column width="70%"}

- GLMs for [count data]{.blue} are very common and have theoretical connections with binary and binomial models.

- This unit focuses on [Poisson regression models]{.blue}. 

- I will not cover the analysis of [contingency tables]{.orange}.

- Such a topic is nonetheless discussed in the textbook but is not part of the exam.

- The most important aspects have been already covered in [Unit B](un_.B.html).
:::

:::

:::callout-tip
The content of this Unit is covered in [Chapter 5]{.orange} of @Salvan2020. Alternatively, see [Chapter 7]{.blue} of @Agresti2015.
:::


## Notation and recap

- In a [Poisson regression]{.blue} model, we observe $Y_i$ independent Poisson random variables, so that
$$
Y_i \overset{\text{ind}}{\sim} \text{Poisson}(\mu_i), \qquad g(\mu_i) = \eta_i = \bm{x}_i^T \beta, \qquad i=1,\dots,n.
$$


- The [canonical link]{.orange} is $g(\cdot) = \log(\cdot)$, which implies a [multiplicative structure]{.blue}
$$
\mu_i = \exp(\bm{x}_i^T \beta) = \exp(\beta_1)^{x_{i1}} \times \cdots \times \exp(\beta_p)^{x_{ip}} = \prod_{j=1}^p \alpha_j^{x_{ij}}, \qquad \alpha_j = \exp(\beta_j).
$$
- Under the canonical link, the [likelihood equations]{.blue} are
$$
\sum_{i=1}^n(y_i - \mu_i)x_{ir} = 0, \qquad r=1,\dots,p.
$$
The solution therefore has a nice interpretation as a [method of moments]{.blue} estimator, in that
$$
\sum_{i=1}^n y_i x_{ir} = \sum_{i=1}^n\mathbb{E}(Y_i) x_{ir}, \qquad r=1,\dots,p.
$$

## Interpretation of the regression coefficients

- Under the [logarithmic link]{.orange}, the mean has a multiplicative structure, namely
$$
\mu_i = \exp(\bm{x}_i^T \beta) = \exp(\beta_1)^{x_{i1}} \times \cdots \times \exp(\beta_p)^{x_{ip}} = \prod_{j=1}^p \alpha_j^{x_{ij}}, \qquad \alpha_j = \exp(\beta_j).
$$

- As a result, a [unitary increase]{.blue} of the $j$th covariate from $x_{ij}$ to $x_{ij} + 1$ has the following impact on the new mean, say $\mu_\text{new}$
$$
\mu_\text{new} = \alpha_1^{x_{i1}} \times \cdots \times \alpha_j^{x_{ij} + 1} \times \cdots \times \alpha_p^{x_{ip}} 
= \alpha_j \left( \alpha_1^{x_{i1}} \times \cdots \times \alpha_p^{x_{ip}} \right) 
= \alpha_j \mu_i.
$$
In other words, the regression parameters, once exponentiated, can be interpreted as [relative changes]{.orange} of the mean, namely
$$
\alpha_j - 1 = \exp(\beta_j) - 1 = \frac{\mu_\text{new} - \mu_i}{\mu_i}.
$$

:::callout-tip
The interpretation in terms of relative changes is a consequence of the [logarithmic link]{.blue} function. Therefore, the same interpretation applies whenever this link is used, including the Gamma GLM.
:::

## Exposure rate

## Overdispersion

## Zero-inflation

## Poisson-multinomial models for contingency tables

## References