<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tommaso Rigon">

<title>Introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="un_intro_files/libs/clipboard/clipboard.min.js"></script>
<script src="un_intro_files/libs/quarto-html/quarto.js"></script>
<script src="un_intro_files/libs/quarto-html/popper.min.js"></script>
<script src="un_intro_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="un_intro_files/libs/quarto-html/anchor.min.js"></script>
<link href="un_intro_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="un_intro_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="un_intro_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="un_intro_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="un_intro_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#homepage" id="toc-homepage" class="nav-link active" data-scroll-target="#homepage">Homepage</a></li>
  <li><a href="#statistics-of-the-20th-century" id="toc-statistics-of-the-20th-century" class="nav-link" data-scroll-target="#statistics-of-the-20th-century">Statistics of the 20th century</a></li>
  <li><a href="#foundations-and-bayesian-statistics" id="toc-foundations-and-bayesian-statistics" class="nav-link" data-scroll-target="#foundations-and-bayesian-statistics">Foundations and Bayesian statistics</a></li>
  <li><a href="#principles-sufficiency-conditionality-and-likelihoods" id="toc-principles-sufficiency-conditionality-and-likelihoods" class="nav-link" data-scroll-target="#principles-sufficiency-conditionality-and-likelihoods">Principles: sufficiency, conditionality and likelihoods</a></li>
  <li><a href="#likelihood" id="toc-likelihood" class="nav-link" data-scroll-target="#likelihood">Likelihood</a></li>
  <li><a href="#estimating-functions" id="toc-estimating-functions" class="nav-link" data-scroll-target="#estimating-functions">Estimating functions</a></li>
  <li><a href="#generalized-linear-models" id="toc-generalized-linear-models" class="nav-link" data-scroll-target="#generalized-linear-models">Generalized linear models</a></li>
  <li><a href="#quasi-likelihoods" id="toc-quasi-likelihoods" class="nav-link" data-scroll-target="#quasi-likelihoods">Quasi likelihoods</a></li>
  <li><a href="#nonparametric-local-models" id="toc-nonparametric-local-models" class="nav-link" data-scroll-target="#nonparametric-local-models">Nonparametric (local) models</a></li>
  <li><a href="#bayesian-methods" id="toc-bayesian-methods" class="nav-link" data-scroll-target="#bayesian-methods">Bayesian methods</a></li>
  <li><a href="#prerequisite-of-this-course" id="toc-prerequisite-of-this-course" class="nav-link" data-scroll-target="#prerequisite-of-this-course">Prerequisite of this course</a></li>
  <li><a href="#statistical-inference" id="toc-statistical-inference" class="nav-link" data-scroll-target="#statistical-inference">Statistical Inference</a></li>
  <li><a href="#dominated-statistical-models" id="toc-dominated-statistical-models" class="nav-link" data-scroll-target="#dominated-statistical-models">Dominated statistical models</a></li>
  <li><a href="#likelihood-function" id="toc-likelihood-function" class="nav-link" data-scroll-target="#likelihood-function">Likelihood function</a></li>
  <li><a href="#textbooks" id="toc-textbooks" class="nav-link" data-scroll-target="#textbooks">Textbooks</a></li>
  <li><a href="#the-future" id="toc-the-future" class="nav-link" data-scroll-target="#the-future">The future</a></li>
  <li><a href="#cynical-and-questionable-advice-for-a-young-investigator" id="toc-cynical-and-questionable-advice-for-a-young-investigator" class="nav-link" data-scroll-target="#cynical-and-questionable-advice-for-a-young-investigator">Cynical and questionable advice for a young investigator</a></li>
  <li><a href="#deconstructing-the-cynical-advice" id="toc-deconstructing-the-cynical-advice" class="nav-link" data-scroll-target="#deconstructing-the-cynical-advice">Deconstructing the cynical advice</a></li>
  <li><a href="#advice-for-a-young-investigator" id="toc-advice-for-a-young-investigator" class="nav-link" data-scroll-target="#advice-for-a-young-investigator">Advice for a young investigator</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#beginner-traps" id="toc-beginner-traps" class="nav-link" data-scroll-target="#beginner-traps">Beginner traps</a></li>
  <li><a href="#beginner-traps-1" id="toc-beginner-traps-1" class="nav-link" data-scroll-target="#beginner-traps-1">Beginner traps</a></li>
  <li><a href="#beginner-traps-2" id="toc-beginner-traps-2" class="nav-link" data-scroll-target="#beginner-traps-2">Beginner traps</a></li>
  <li><a href="#beginner-traps-3" id="toc-beginner-traps-3" class="nav-link" data-scroll-target="#beginner-traps-3">Beginner traps</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="un_intro_slides.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction</h1>
<p class="subtitle lead">Statistical Inference - PhD EcoStatData</p>
</div>


<div class="quarto-title-meta-author column-page-left">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><span class="orange">Tommaso Rigon</span> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <em>Università degli Studi di Milano-Bicocca</em>
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-page-left">

      
  
    
  </div>
  


</header>


<section id="homepage" class="level2">
<h2 class="anchored" data-anchor-id="homepage"><a href="../index.html">Homepage</a></h2>
<div class="columns">
<div class="column" style="width:35%;">
<p><img src="img/cox.jpg" class="img-fluid" style="width:3in"></p>
<div style="font-size: 80%;">
<p><em>“I would like to think of myself as a scientist, who happens largely to specialise in the use of statistics.”</em></p>
<p><a href="https://royalsocietypublishing.org/doi/10.1098/rsbm.2023.0052#:~:text=David%20described%20himself%20as%20a,of%20his%20interest%20in%20applications." class="grey">Sir David Cox</a> (1924-2022)</p>
</div>
</div><div class="column" style="width:65%;">
<ul>
<li><p>This course will cover the following <span class="orange">topics</span>:</p>
<ul>
<li>Point estimation</li>
<li>Exponential families</li>
<li>Generalized linear models</li>
<li>…and more advanced topics</li>
</ul></li>
<li><p>This is a <span class="blue">Ph.D.-level</span> course, so it is assumed that you have already been exposed to all these topics to some extent.</p></li>
<li><p>We aim to (briefly!) touch upon many <span class="blue">key concepts</span> of <span class="orange">classical statistical inference</span> from the <span class="blue">20th century</span>.</p></li>
<li><p>Fundamental topics such as <span class="blue">hypothesis testing</span> are not covered here, as they are addressed in another module.</p></li>
<li><p>To introduce the main ideas, I will borrow the words of <span class="citation" data-cites="Davison2001">Davison (<a href="#ref-Davison2001" role="doc-biblioref">2001</a>)</span> — a source you are <span class="orange">encouraged to read!</span></p></li>
</ul>
</div>
</div>
</section>
<section id="statistics-of-the-20th-century" class="level2">
<h2 class="anchored" data-anchor-id="statistics-of-the-20th-century">Statistics of the 20th century</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:7in"></p>
</figure>
</div>
<ul>
<li><span class="orange">Biometrika</span> is among the most prestigious journals in Statistics. Past editors include Karl Pearson, Sir David Cox, and Anthony Davison.</li>
</ul>
</section>
<section id="foundations-and-bayesian-statistics" class="level2">
<h2 class="anchored" data-anchor-id="foundations-and-bayesian-statistics">Foundations and Bayesian statistics</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:7in"></p>
</figure>
</div>
</section>
<section id="principles-sufficiency-conditionality-and-likelihoods" class="level2">
<h2 class="anchored" data-anchor-id="principles-sufficiency-conditionality-and-likelihoods">Principles: sufficiency, conditionality and likelihoods</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:7in"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison3_5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:7in"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:7in"></p>
</figure>
</div>
</section>
<section id="likelihood" class="level2">
<h2 class="anchored" data-anchor-id="likelihood">Likelihood</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:7in"></p>
</figure>
</div>
<ul>
<li>The study of the <span class="orange">likelihood</span> has gone <span class="blue">far beyond</span> the classical <span class="blue">textbook</span> description. Specialized topics that have attracted considerable attention include:
<ul>
<li>Likelihood ratio tests and their large-sample properties<br>
</li>
<li>Conditional and marginal likelihoods<br>
</li>
<li>Modified profile likelihoods<br>
</li>
<li>Restricted maximum likelihood</li>
</ul></li>
</ul>
</section>
<section id="estimating-functions" class="level2">
<h2 class="anchored" data-anchor-id="estimating-functions">Estimating functions</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:7in"></p>
</figure>
</div>
</section>
<section id="generalized-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="generalized-linear-models">Generalized linear models</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:7in"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison7_5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:7in"></p>
</figure>
</div>
</section>
<section id="quasi-likelihoods" class="level2">
<h2 class="anchored" data-anchor-id="quasi-likelihoods">Quasi likelihoods</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison8.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:7in"></p>
</figure>
</div>
</section>
<section id="nonparametric-local-models" class="level2">
<h2 class="anchored" data-anchor-id="nonparametric-local-models">Nonparametric (local) models</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison9.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:7in"></p>
</figure>
</div>
</section>
<section id="bayesian-methods" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-methods">Bayesian methods</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison10.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:6in"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison11.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:6in"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison11_5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:6in"></p>
</figure>
</div>
<!-- ## Other topics -->
<!-- - Davison's paper covers many other topics beyond the scope of this overview, including: -->
<!-- - [Model selection]{.blue}: information criteria such as AIC and its variants; [robustness]{.orange} and model diagnostics. -->
<!-- - [Computational methods]{.grey}: simulation techniques including Markov Chain Monte Carlo; analytical approximations such as saddlepoint and Laplace methods. -->
<!-- - [Missing data]{.blue}, counterfactual reasoning, and causal inference frameworks. -->
<!-- - [Specialized modeling]{.orange}: approaches for longitudinal and clustered data, multivariate analysis, factor modelling, graphical models, and spatial statistics. -->
</section>
<section id="prerequisite-of-this-course" class="level2">
<h2 class="anchored" data-anchor-id="prerequisite-of-this-course">Prerequisite of this course</h2>
<ul>
<li><p>As mentioned, it is assumed that you have already been exposed to courses on statistical inference before.</p></li>
<li><p><span class="blue">Propedeutical</span> topics that I will <span class="orange">not</span> discuss here are:</p>
<ul>
<li>Asymptotic probability theory, <span class="math inline">O_p(\cdot)</span> and <span class="math inline">o_p(\cdot)</span> notations</li>
<li>Likelihood function: definition and basic properties</li>
<li>Sufficiency, ancillarity, Fisher factorization theorem, minimality</li>
<li>Tests based on the likelihood (likelihood ratio, score test, Wald test), asymptotically equivalent forms, confidence intervals</li>
<li>Linear models, ordinary least squares, exact normal theory</li>
</ul></li>
<li><p>If you are unfamiliar with any of these, please have a look at Chap. 2 and Chap. 3 of <span class="citation" data-cites="Pace1997">Pace and Salvan (<a href="#ref-Pace1997" role="doc-biblioref">1997</a>)</span>, and <span class="citation" data-cites="Davison2003">Davison (<a href="#ref-Davison2003" role="doc-biblioref">2003</a>)</span>.</p></li>
</ul>
</section>
<section id="statistical-inference" class="level2">
<h2 class="anchored" data-anchor-id="statistical-inference">Statistical Inference</h2>
<ul>
<li><p>The key assumption is that <span class="orange">observations</span> <span class="math inline">y_1,\dots, y_n</span>, seen as realizations of the <span class="blue">random variables</span> <span class="math inline">(Y_1,\dots,Y_n) \sim P_\theta</span>, provide information about the <span class="orange">generating process</span> <span class="math inline">P_\theta(\cdot)</span>.</p></li>
<li><p>We assume that <span class="math inline">P_\theta</span> is only partially known; that is, it belongs to a <span class="orange">model class</span> specified by the tuple <span class="math display">
(\mathcal{Y}, P_\theta, \Theta),
</span> where <span class="math inline">\mathcal{Y}</span> is the <span class="blue">sample space</span>, <span class="math inline">P_\theta</span> is a <span class="grey">probability measure</span> over <span class="math inline">\mathcal{Y}</span> indexed by <span class="math inline">\theta \in \Theta</span>, and <span class="math inline">\Theta</span> is the <span class="orange">parameter space</span>.</p></li>
<li><p>In this course, we focus on the <span class="orange">parametric case</span>, where <span class="math inline">\Theta \subseteq \mathbb{R}^p</span>. Hence, <span class="math inline">\theta \in \Theta</span> is a vector-valued <span class="orange">parameter</span> that we aim to infer from the data.</p></li>
<li><p>If instead <span class="math inline">\Theta</span> is not a subset of <span class="math inline">\mathbb{R}^p</span>, then we are in the domain of <span class="blue">nonparametric statistics</span>.</p></li>
<li><p>A basic requirement is <span class="blue">identifiability</span>, meaning that <span class="math display">
\text{if} \quad \theta_1 \neq \theta_2, \qquad P_{\theta_1} \neq P_{\theta_2},
</span> that is, there exists a measurable set <span class="math inline">A \in \mathcal{B}(\mathcal{Y})</span> such that <span class="math inline">P_{\theta_1}(A) \neq P_{\theta_2}(A)</span>.</p></li>
</ul>
</section>
<section id="dominated-statistical-models" class="level2">
<h2 class="anchored" data-anchor-id="dominated-statistical-models">Dominated statistical models</h2>
<ul>
<li><p>We will focus on <span class="orange">dominated families</span> of distributions, namely we assume there exist a measure <span class="math inline">\nu(\mathrm{d}\bm{y})</span> over <span class="math inline">\mathcal{B}(\mathcal{Y})</span> such that <span class="math inline">P_\theta</span> is absolutely continuous w.r.t. <span class="math inline">\nu</span> for all <span class="math inline">\theta \in \Theta</span>, that is <span class="math display">
\forall A\in \mathcal{B}(\mathcal{Y}) \quad \text{ such that } \quad \nu(A) = 0 \quad\implies \quad P_\theta(A) = 0.
</span></p></li>
<li><p><span class="grey">Radon-Nikodym</span> theorem then ensures there exists a <span class="blue">probability density</span> <span class="math inline">f(\bm{y}; \theta)</span> such that <span class="math display">
P_\theta(A) = \int_A f(\bm{y}; \theta)\nu(\mathrm{d}\bm{y}).
</span> If <span class="math inline">\mathcal{Y} \subseteq \mathbb{R}^d</span>, then <span class="math inline">\nu</span> is typically the <span class="blue">Lebesgue measure</span> or the <span class="orange">counting measure</span>.</p></li>
<li><p>A <span class="orange">dominated statistical model</span> is therefore identified by the following class of densities: <span class="math display">
\mathcal{F} = \{f(\cdot;\theta) : \theta \in \Theta \subseteq \mathbb{R}^p\},
</span> or more precisely by the tuple <span class="math inline">(\mathcal{Y}, f(\cdot;\theta), \Theta)</span>, with <span class="math inline">\Theta \subseteq \mathbb{R}^p</span>. We will only consider the dominated case in this course.</p></li>
</ul>
</section>
<section id="likelihood-function" class="level2">
<h2 class="anchored" data-anchor-id="likelihood-function">Likelihood function</h2>
<ul>
<li><p>Let <span class="math inline">\mathcal{F}</span> be a <span class="blue">dominated (parametric) statistical model</span> and <span class="math inline">\bm{y} = (y_1,\dots,y_n) \in \mathcal{Y}</span> the observed data. Let <span class="math inline">c  = c(\bm{y}) &gt; 0</span> be a positive <span class="orange">arbitrary constant</span>, the function <span class="math inline">L : \Theta \to \mathbb{R}^+</span> defined as <span class="math display">
L(\theta) = L(\theta;\bm{y}) = c(\bm{y}) f(\bm{y}; \theta), \qquad \theta \in \Theta,
</span> is called <span class="orange">likelihood function</span>. The log-likelihood function is <span class="math inline">\ell(\theta) := \log{L(\theta)}</span>.</p></li>
<li><p>Some authors set <span class="math inline">c = 1</span>, but this is <span class="orange">debatable</span>. Indeed, defining the likelihood <span class="blue">up to a multiplicative factor</span> can be justified in multiple ways:</p></li>
<li><p>Intuitively, when comparing the coherency of two statistical models with the observed data, we only care about ratios of the form <span class="math inline">L(\theta_1;\bm{y}) / L(\theta_2;\bm{y})</span> where the constant simplifies.</p></li>
<li><p>Moreover, this definition does not depend on the choice of the dominating measure <span class="math inline">\nu</span>.</p></li>
<li><p>In particular, the likelihood is <span class="blue">invariant</span> under <span class="orange">one-to-one transformations</span> of the data, as the jacobian of the transformation can be incorporated into <span class="math inline">c(\bm{y})</span>.</p></li>
<li><p>This is also the <span class="grey">original definition</span> provided by <span class="grey">Fisher</span> in 1922!</p></li>
</ul>
</section>
<section id="textbooks" class="level2">
<h2 class="anchored" data-anchor-id="textbooks">Textbooks</h2>
<ul>
<li><p>We will use multiple textbooks throughout this course — some more specialized than others. Please treat them as reference materials to consult as needed.</p></li>
<li><p>Roughly speaking, they can be organized as follows:</p>
<ul>
<li><span class="blue">General references</span>: <span class="citation" data-cites="Casella2002">Casella and Berger (<a href="#ref-Casella2002" role="doc-biblioref">2002</a>)</span>, <span class="citation" data-cites="Davison2003">Davison (<a href="#ref-Davison2003" role="doc-biblioref">2003</a>)</span>, and <span class="citation" data-cites="Pace1997">Pace and Salvan (<a href="#ref-Pace1997" role="doc-biblioref">1997</a>)</span></li>
<li><span class="grey">Point estimation</span>: <span class="citation" data-cites="Lehmann1998">Lehmann and Casella (<a href="#ref-Lehmann1998" role="doc-biblioref">1998</a>)</span> and <span class="citation" data-cites="Keener2010">Keener (<a href="#ref-Keener2010" role="doc-biblioref">2010</a>)</span></li>
<li><span class="orange">Exponential families</span>: <span class="citation" data-cites="Pace1997">Pace and Salvan (<a href="#ref-Pace1997" role="doc-biblioref">1997</a>)</span></li>
<li><span class="blue">Asymptotic statistics</span>: <span class="citation" data-cites="vandervaart1998">van der Vaart (<a href="#ref-vandervaart1998" role="doc-biblioref">1998</a>)</span></li>
<li><span class="grey">Generalized linear models</span>: <span class="citation" data-cites="Agresti2015">Agresti (<a href="#ref-Agresti2015" role="doc-biblioref">2015</a>)</span>, <span class="citation" data-cites="McCullagh1989">McCullagh and Nelder (<a href="#ref-McCullagh1989" role="doc-biblioref">1989</a>)</span></li>
</ul></li>
<li><p>The book by <span class="citation" data-cites="Davison2003">Davison (<a href="#ref-Davison2003" role="doc-biblioref">2003</a>)</span> is perhaps the most accessible among the listed texts. You are encouraged to refer to it if you need to review or catch up on prerequisite material.</p></li>
<li><p>In addition, specialized articles and resources will be discussed throughout the course to complement the textbook material.</p></li>
</ul>
</section>
<section id="the-future" class="level2">
<h2 class="anchored" data-anchor-id="the-future">The future</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison12.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:8in"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Davison13.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:8in"></p>
</figure>
</div>
</section>
<section id="cynical-and-questionable-advice-for-a-young-investigator" class="level2">
<h2 class="anchored" data-anchor-id="cynical-and-questionable-advice-for-a-young-investigator">Cynical and questionable advice for a young investigator</h2>
<ol type="1">
<li><p>Strive to <span class="blue">publish</span> in <span class="orange">top statistical journals</span>, such as: <em>Annals of Statistics, Biometrika, Journal of the American Statistical Association, Journal of the Royal Statistical Society: Series B</em>.</p></li>
<li><p>However, keep in mind that both <span class="blue">quality</span> and <span class="orange">quantity</span> matter. Aim to have at least 2–4 submitted or published papers by the end of your Ph.D.&nbsp;— the more, the better.</p></li>
<li><p>Focus on a <span class="orange">niche trending topic</span>. Make sure you are part of a <span class="blue">large</span> and <span class="blue">established group</span> of researchers who actively promote the topic you are working on.</p></li>
<li><p>Become an <span class="blue">expert</span> in your niche, and learn how to <span class="blue">write</span> about it and promote it effectively. In a nutshell, <span class="orange">learn</span> how to <span class="orange">play the game</span>.</p></li>
<li><p>Closely follow the <span class="blue">suggestions</span> of your <span class="blue">advisor</span> — they know better than you how to navigate the system and can guide you through many political and scientific challenges.</p></li>
<li><p><span class="orange">Do not wast time</span> on activities that do not produce papers. This include:</p>
<ul>
<li>Teaching to undergraduate students</li>
<li>Disseminating your work to the broader community, beyond academia</li>
<li>Studying topics unrelated to your niche area</li>
</ul></li>
</ol>
</section>
<section id="deconstructing-the-cynical-advice" class="level2">
<h2 class="anchored" data-anchor-id="deconstructing-the-cynical-advice">Deconstructing the cynical advice</h2>
<ul>
<li><p>The former is a list of concrete recommendations (easier said than done, especially about publishing on top journals) that may help you secure a <span class="blue">permanent position</span> in <span class="blue">academia</span>.</p></li>
<li><p>I <span class="orange">do not fully agree</span> with those rules: there is more to pursuing a Ph.D.&nbsp;than just “getting a job.”</p></li>
<li><p>These suggestions may change over time and do not necessarily apply to other fields. Moreover, keep in mind academia, in the <span class="orange">short period</span>, is also a <span class="blue">game of chance</span>.</p></li>
<li><p>I recognize their <span class="blue">effectiveness</span>, but there are, I think, some <span class="orange">uncomfortable</span> consequences.</p></li>
</ul>
<div class="callout callout-style-simple callout-warning no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li><p>These rules may lead to an <span class="orange">unhealthy competition</span> among peers, who struggle to <span class="blue">publish or perish</span>, which has <span class="orange">negative psychological</span> effects and it favors <span class="orange">incremental</span> contributions.</p></li>
<li><p>Even if they work in the <span class="orange">short period</span>, in the <span class="blue">long run</span>, if the niche you decided to focus on is declining, transitioning towards different topics is hard if have not studied anything else.</p></li>
<li><p>If the academic system rewards specialization, why study <span class="orange">classical statistics</span> or other topics at all? What about the role of Universities in <span class="blue">preserving</span> and <span class="blue">disseminating knowledge</span>?</p></li>
<li><p>These suggestions apply to academia and do not consider <span class="blue">working</span> in <span class="blue">industry</span> after the Ph.D., which is what many (most?) Ph.D.&nbsp;students will do.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="advice-for-a-young-investigator" class="level2">
<h2 class="anchored" data-anchor-id="advice-for-a-young-investigator">Advice for a young investigator</h2>
<div class="columns">
<div class="column" style="width:25%;">
<p><img src="img/advice.jpg" class="img-fluid" style="width:3in"></p>
<div style="font-size: 80%;">
<p><span class="grey">Santiago Ramon Y Cajal</span> (1852–1934)</p>
</div>
</div><div class="column" style="width:75%;">
<ul>
<li><p>The former list of practical advice is probably <span class="orange">effective</span> but <span class="orange">questionable</span>. For sure, it lacks <span class="blue">perspective</span>.</p></li>
<li><p>In looking for <span class="blue">principles</span> defining a <span class="orange">good researcher</span>, I once again need to borrow the words of somebody else.</p></li>
<li><p><span class="grey">Santiago Ramón y Cajal</span> is a fascinating personalities in science. He was one of the most important <span class="blue">neuroanatomist</span> of his century.</p></li>
<li><p>Cajal was also a <span class="orange">thoughtful</span> and inspired <span class="orange">teacher</span>.</p></li>
<li><p>“The advice” became vehicle for Cajal to write down the thoughts and anecdotes he would give to students and colleagues about how to make <span class="blue">important original contributions</span> in any branch of <span class="orange">science</span>.</p></li>
<li><p>This book was written in 1898. The world was different, and so was academia. Yet, the book feels remarkably <span class="blue">modern</span>.</p></li>
</ul>
</div>
</div>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
On general philosophical principles
</div>
</div>
<div class="callout-body-container callout-body">
<div style="font-size: 80%;">
<p><em>It is important to note that the most brilliant discoveries have not relied on a formal knowledge of logic. Instead, their discoverers have had an <span class="blue">acute inner logic</span> that generates ideas […]</em></p>
<p><em>Let me assert without further ado that <span class="orange">there are no rules of logic</span> for <span class="blue">making discoveries</span> […]</em></p>
<p><em>Must we therefore abandon any attempt to instruct and educate about the process of scientific research? Shall we leave the beginner to his own devices, confused and abandoned, struggling without guidance or advice along a path strewn with difficulties and dangers?</em></p>
<p><em>Definitely not. In fact, just the opposite — we believe that by <span class="orange">abandoning</span> the <span class="orange">ethereal realm of philosophical principles</span> and abstract methods we can descend to the <span class="blue">solid ground</span> of <span class="blue">experimental science</span>, as well as to the sphere of ethical considerations involved in the process of inquiry. In taking this course, simple, genuinely useful advice for the novice can be found.</em></p>
</div>
</div>
</div>
</section>
<section id="beginner-traps" class="level2">
<h2 class="anchored" data-anchor-id="beginner-traps">Beginner traps</h2>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Undue admiration of authority
</div>
</div>
<div class="callout-body-container callout-body">
<div style="font-size: 80%;">
<p><em>I believe that <span class="orange">excessive admiration</span> for the work of <span class="blue">great minds</span> is one of the most <span class="orange">unfortunate preoccupations</span> of intellectual youth — along with a conviction that certain problems cannot be attacked, let alone solved, because of one’s relatively limited abilities.</em></p>
<p><em>Inordinate respect for genius is based on a commendable sense of fairness and modesty that is difficult to censure. However, when foremost in the mind of a novice, it <span class="orange">cripples initiative</span> and prevents the formulation of <span class="blue">original work</span>. Defect for defect, arrogance is preferable to diffidence, boldness measures its strengths and conquers or is conquered, and undue modesty flees from battle, condemned to <span class="orange">shameful inactivity</span>. […]</em></p>
<p><em>Far from humbling one’s self before the great authorities of science, those beginning research must understand that […] their destiny is to <span class="blue">grow a little</span> at the <span class="orange">expense of the great one</span>’s reputation. […]</em></p>
<p><em>By way of classic examples, recall Galileo refuting <a href="https://en.wikipedia.org/wiki/Aristotelian_physics">Aristotle’s view of gravity</a>, Copernicus tearing down <a href="https://en.wikipedia.org/wiki/Geocentric_model">Ptolemy’s system of the universe</a>, Lavoisier destroying Stahl’s concept of <a href="https://en.wikipedia.org/wiki/Phlogiston_theory">phlogiston</a>, and Virchow refuting the idea of <a href="https://en.wikipedia.org/wiki/Spontaneous_generation">spontaneous generation</a> held by Schwann, Schleiden, and Robin. […]</em></p>
<p><em>It could be said that in our times, when so many idols have been dethroned and so many illusions destroyed or forgotten, there is little need for resorting to a <span class="blue">critical sense</span> and <span class="orange">spirit of doubt</span>. […] However, old habits die hard — too often one still encounters the pupils of illustrious men wasting their talents on <span class="orange">defending the errors</span> of their <span class="orange">teachers</span>, rather than using them to solve new problems.</em></p>
</div>
</div>
</div>
</section>
<section id="beginner-traps-1" class="level2">
<h2 class="anchored" data-anchor-id="beginner-traps-1">Beginner traps</h2>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The most important problems are already solved
</div>
</div>
<div class="callout-body-container callout-body">
<div style="font-size: 80%;">
<p><em>Here is another <span class="orange">false concept</span> often heard from the lips of the newly graduated:</em> “Everything of major importance in the various areas of science has already been clarified. What difference does it make if I add some minor detail or gather up what is left in some field where more diligent observers have already collected the abundant, ripe grain. Science won’t change its perspective because of my work, and my name will never emerge from obscurity.”</p>
<p><em>This is often <span class="orange">indolence masquerading as modesty</span>. […]</em></p>
<p><em>Instead, bear in mind that even in our own time science is often built on the <span class="blue">ruins of theories</span> once thought to be <span class="blue">indestructible</span>. It is important to realize that if certain areas of science appear to be quite <span class="blue">mature</span>, <span class="orange">others</span> are in the process of <span class="orange">development</span>, and yet others remain to be born. […]</em></p>
<p><em>It is fair to say that, in general, no problems have been exhausted; instead, men have been exhausted by the problems. […] <span class="blue">Fresh talent</span> approaching the analysis of a problem <span class="blue">without prejudice</span> will always see new possibilities — some aspect not considered by those who believe that a subject is fully understood. Our knowledge is so fragmentary that unexpected findings appear in even the most fully explored topics.</em></p>
</div>
</div>
</div>
</section>
<section id="beginner-traps-2" class="level2">
<h2 class="anchored" data-anchor-id="beginner-traps-2">Beginner traps</h2>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preoccupation with applied science
</div>
</div>
<div class="callout-body-container callout-body">
<div style="font-size: 80%;">
<p><em>Another corruption of thought that is important to battle at all costs is the false distinction between</em> <span class="orange">theoretical</span> <em>and</em> <span class="blue">applied</span> <em>science, with accompanying <span class="blue">praise of the latter</span> and <span class="orange">deprecation</span> of the <span class="orange">former</span>.</em></p>
<p><em>This lack of appreciation is definitely shared by the <span class="grey">average citizen</span>, often including lawyers, writers, industrialists, and <span class="orange">unfortunately</span> even distinguished <span class="orange">statesmen</span>, whose initiatives can have serious consequences for the cultural development of their nation. […]</em></p>
<p><em>People with little understanding fail to observe the <span class="orange">mysterious threads</span> that bind the factory to the laboratory, just as the stream is connected with its source. Like the man in the street, they believe in good faith that scholars may be divided into two groups — those who waste time speculating about unfruitful lines of pure science, and those who know how to find data that can be applied immediately to the advancement and comfort of life.</em></p>
<p><em>Is it really necessary to dwell on such an <span class="blue">absurd point of view</span>? Does anyone lack the common sense to understand that <span class="blue">applications</span> derive immediately from the <span class="orange">discovery of fundamental principles</span> and new data? […]</em></p>
<p><em>For the present, let us cultivate <span class="blue">science for its own sake</span>, without considering its <span class="orange">applications</span>. They will always come, whether in years or perhaps even in centuries. It matters very little whether scientific truth is used by our sons or by our grandsons. […] Accept the view that <span class="orange">nothing</span> in nature is <span class="orange">useless</span>, even from the human point of view. Even in the rare instance where it may not be possible to use particular scientific breakthroughs for our comfort and benefit, there is one positive benefit — the noble satisfaction of our curiosity and the incomparable gratification and feeling of power that accompany the solving of a difficult problem.</em></p>
</div>
</div>
</div>
</section>
<section id="beginner-traps-3" class="level2">
<h2 class="anchored" data-anchor-id="beginner-traps-3">Beginner traps</h2>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Perceived lack of ability
</div>
</div>
<div class="callout-body-container callout-body">
<div style="font-size: 80%;">
<p><em>Some people claim a <span class="blue">lack of ability for science</span> to justify failure and discouragement. […] but the great majority of those professing incompetence really so? Might they exaggerate how difficult the task will be, and <span class="orange">underestimate their own abilities</span>? I believe that this is often the case. […]</em></p>
<p><em>As many teachers and thinkers have noted, discoveries are <span class="orange">not</span> the fruit of <span class="orange">outstanding talent</span>, but rather of <span class="blue">common sense</span> enhanced and strengthened by <span class="blue">technical education</span> and a habit of <span class="blue">thinking about scientific problems</span>. […]</em></p>
<p><em>What we refer to as a great and special talent usually implies superiority that is <span class="orange">expeditious</span> rather than <span class="blue">qualitative</span>. In other words, it simply means doing quickly and with brilliant success what ordinary intellects carry out slowly <span class="blue">but well</span>.</em></p>
<p><em>Instead of distinguishing between mediocre and great minds, it would be preferable and more correct in most instances to classify them as slow and facile. The latter are certainly more brilliant and stimulating — there is no substitute for them in conversation, oratory, and journalism, that is, in all lines of work where time is a decisive factor. However, in scientific undertakings the slow prove to be as useful as the fast because scientists like artists are judged by the <span class="blue">quality of what they produce</span>, <span class="orange">not</span> by the <span class="orange">speed of production</span>.</em></p>
</div>
</div>
</div>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Agresti2015" class="csl-entry" role="listitem">
Agresti, A. (2015), <em><span class="nocase">Foundations of Linear and Generalized Linear Models</span></em>, Wiley.
</div>
<div id="ref-Birnbaum1962" class="csl-entry" role="listitem">
Birnbaum, A. (1962), <span>“<span class="nocase">On the foundations of statistical inference</span>,”</span> <em>Journal of the American Statistical Association</em>, 57, 269–306.
</div>
<div id="ref-Cajal1916" class="csl-entry" role="listitem">
Cajal, S. R. Y. (1999), <em>Advice for a young investigator</em>, MIT Press.
</div>
<div id="ref-Casella2002" class="csl-entry" role="listitem">
Casella, G., and Berger, R. L. (2002), <em><span>Statistical Inference</span></em>, Duxbury.
</div>
<div id="ref-Davison2001" class="csl-entry" role="listitem">
Davison, A. C. (2001), <span>“<span class="nocase">Biometrika centenary: theory and general methodology</span>,”</span> <em>Biometrika</em>, 88, 13–52.
</div>
<div id="ref-Davison2003" class="csl-entry" role="listitem">
Davison, A. C. (2003), <em><span>Statistical Models</span></em>, Cambridge University Press.
</div>
<div id="ref-Keener2010" class="csl-entry" role="listitem">
Keener, R. W. (2010), <em><span>Theoretical Statistics</span></em>, Springer.
</div>
<div id="ref-Lehmann1998" class="csl-entry" role="listitem">
Lehmann, E. L., and Casella, G. (1998), <em><span class="nocase">Theory of Point Estimation, Second Edition</span></em>, Springer.
</div>
<div id="ref-McCullagh1989" class="csl-entry" role="listitem">
McCullagh, P., and Nelder, J. A. (1989), <em>Generalized linear models</em>, Chapman &amp; Hall/CRC.
</div>
<div id="ref-Pace1997" class="csl-entry" role="listitem">
Pace, L., and Salvan, A. (1997), <em><span class="nocase">Principles of statistical inference from a Neo-Fisherian perspective</span></em>, Advanced series on statistical science and applied probability, World Scientific.
</div>
<div id="ref-vandervaart1998" class="csl-entry" role="listitem">
van der Vaart, A. W. (1998), <em><span>Asymptotic Statistics</span></em>, Cambridge University Press.
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="un_intro_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>