---
title: "Exercises A"
subtitle: "Statistical Inference - Ph.D. in Economics, Statistics, and Data Science"
author: "[Tommaso Rigon]{.orange}"
institute: "_Universit√† degli Studi di Milano-Bicocca_"
page-layout: full
bibliography: ../biblio.bib
citeproc: true
csl: https://www.zotero.org/styles/journal-of-the-american-statistical-association
reference-location: margin
execute:
  cache: false
format:
  html:
    html-math-method: katex
    echo: false
    callout-appearance: minimal
    theme: [simplex, ../template.css]
    toc: true
    toc-title: Table of contents
    embed-resources: false
    code-line-numbers: true
    smooth-scroll: true
    code-fold: false
    code-summary: "Show the code"
    fig-dpi: 150
    highlight-style: github
editor: 
  markdown: 
    wrap: 72
editor_options: 
  chunk_output_type: console
---

# [Homepage](../index.html)

## Theoretical

:::{.callout-note collapse=true}
#### **Salvan et al. (2020), Exercise 1.8**

Suppose the normal linear model $\bm{Y} = \bm{X}\beta + z\gamma + \bm{\epsilon}$,  with $\bm{X}$ an $n \times p$ matrix (rank $p<n$), $\bm{z}$ an $n \times 1$ vector, and $\bm{\epsilon} \sim \text{N}_n(0,\sigma^2 I_n)$. We instead fit $\bm{Y} = \bm{X}\beta + \bm{\varepsilon}$, with 
$$
\hat{\beta} = (\bm{X}^T \bm{X})^{-1}\bm{X}^T \bm{y}, \qquad \bm{r} = (I_n - \bm{H})\bm{y}.
$$

(a) Show that $$
\bm{r} = (I_n - \bm{H})\bm{z}\gamma + (I_n - \bm{H})\bm{\epsilon}$$ 
so $\mathbb{E}(\bm{r}) = (I_n - \bm{H})\bm{z}\gamma$. What if $\bm{z}$ lies in the column space of $\bm{X}$?  

(b) Explain why the [added-variable plot]{.blue} (residuals $\bm{r}$ vs. residuals from regressing $\bm{z}$ on $\bm{X}$) helps assess whether to include $\bm{z}$.  

(c) Using the plots in the figure below, comment on the result and suggest how to modify the model.

```{r}
set.seed(123)
x1 <- runif(100, 0, 1)
x2 <- runif(100, 0, 1)
z <- 3 * x1 + rnorm(100, 0, 0.2)
y <- 1 + x1 + x2 - 5 * z + rnorm(100, 0, 0.3)

plot(z, residuals(lm(y ~ x1 + x2)), pch = 16)
plot(residuals(lm(z ~ x1 + x2)), residuals(lm(y ~ x1 + x2)), pch = 16)
```


:::

## Data analysis

::: {.callout-note collapse=true}
#### **Agresti (2015), Exercise 1.21**

Littell et al. (2000) reported a pharmaceutical clinical trial involving $n = 72$ patients, randomly assigned to three treatment groups (drug A, drug B, and placebo), with 24 patients per group. The outcome of interest was respiratory function, measured as FEV1 (forced expiratory volume in one second, in liters). The dataset `FEV.dat` is [available here](../data/FEV.dat); the first six observations are shown below.

In this analysis, let $y$ denote the FEV1 value after one hour of treatment (variable `fev1` in the dataset). Define 

- $x_1$: baseline FEV1 measurement prior to treatment (`base`),  
- $x_2$: treatment group (categorical variable `drug` with labels `a`, `b`, `p`).  

[Download the data](../data/FEV.dat) and fit linear models for $y$ using the following sets of predictors: (i) $x_1$ only, (ii) $x_2$ only, (iii) both $x_1$ and $x_2$. For each model, [interpret]{.blue} the estimated parameters.

```{r}
FAV <- read.table("../data/FEV.dat", header = TRUE)
knitr::kable(head(FAV))
```

:::


:::{.callout-note collapse=true}
#### **Agresti (2015), Exercise 1.24**

For $n = 72$ young girls diagnosed with anorexia, the dataset `Anorexia.dat` [available here](../data/Anorexia.dat) records their body weights (in lbs) before and after an experimental treatment period. The data format is illustrated below. During the study, the participants were randomly assigned to one of three therapy groups:  

- **Control group**: received the standard therapy (label `c`),  
- **Family therapy** (label `f`),  
- **Cognitive behavioral therapy** (label `b`).  

[Download the data](../data/Anorexia.dat) and fit a linear model where the outcome is the [post-treatment weight]{.blue} and the predictors are the [baseline weight]{.orange} and the [therapy group]{.orange}.   [Interpret]{.blue} the estimated parameters of the model.

Convert the weights to kilograms ($1\ \text{lb} = 0.453592\ \text{kg}$), repeat the analysis, and discuss whether the results change and why.  

```{r}
Anorexia <- read.table("../data/Anorexia.dat", header = TRUE)
knitr::kable(head(Anorexia))
```

:::