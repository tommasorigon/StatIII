<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tommaso Rigon">

<title>Exercises A</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="exe_A_files/libs/clipboard/clipboard.min.js"></script>
<script src="exe_A_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="exe_A_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="exe_A_files/libs/quarto-html/popper.min.js"></script>
<script src="exe_A_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="exe_A_files/libs/quarto-html/anchor.min.js"></script>
<link href="exe_A_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="exe_A_files/libs/quarto-html/quarto-syntax-highlighting-92eaa9f3cac64f6982a8a06e2ba947a3.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="exe_A_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="exe_A_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="exe_A_files/libs/bootstrap/bootstrap-6592efaa0f983b15af3ead25d4d882b3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#homepage" id="toc-homepage" class="nav-link active" data-scroll-target="#homepage">Homepage</a>
  <ul class="collapse">
  <li><a href="#data-analysis" id="toc-data-analysis" class="nav-link" data-scroll-target="#data-analysis">Data analysis</a></li>
  <li><a href="#theoretical" id="toc-theoretical" class="nav-link" data-scroll-target="#theoretical">Theoretical</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exercises A</h1>
<p class="subtitle lead">Statistics III - CdL SSE</p>
</div>


<div class="quarto-title-meta-author column-page-left">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><span class="orange">Tommaso Rigon</span> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <em>Università degli Studi di Milano-Bicocca</em>
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-page-left">

      
  
    
  </div>
  


</header>


<section id="homepage" class="level1">
<h1><a href="../index.html">Homepage</a></h1>
<p>The theoretical exercises described below are quite <span class="orange">difficult</span>. At the <span class="blue">exam</span>, you can expect a <span class="blue">simplified version</span> of them; otherwise, they would represent a formidable challenge for most of you.</p>
<p>On the other hand, the data analyses are more or less aligned with what you may encounter in the final examination.</p>
<section id="data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="data-analysis">Data analysis</h2>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>Abrasion</code> dataset
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The dataset <code>Abrasion</code> (Hand et al., 1994), available in the <code>MLGdata</code> R package, comes from an experiment designed to evaluate how the abrasion resistance of a certain type of rubber is affected by its hardness and tensile strength. Thirty rubber samples were subjected to constant abrasion for a fixed duration, and the resulting weight loss (<code>perdita</code>, in grams per hour) was recorded. For each sample, the following variables were also measured:</p>
<ul>
<li><code>D</code>: hardness (in Shore degrees),<br>
</li>
<li><code>Re</code>: tensile strength (kg/cm²).</li>
</ul>
<ol type="a">
<li><p>Identify the statistical units, the response variable, and the explanatory variables, specifying the type of each variable (continuous quantitative, discrete quantitative, nominal qualitative, ordinal qualitative).</p></li>
<li><p>Perform a graphical analysis to assess whether a linear regression model may be appropriate.</p></li>
<li><p>Specify a simple linear regression model, choosing an appropriate explanatory variable.</p></li>
<li><p>Fit the simple linear regression model from (c) in <strong>R</strong>.</p></li>
<li><p>Report the estimates and 95% confidence intervals for the coefficients. Interpret the estimated values.</p></li>
<li><p>For each element of the R <code>summary</code> output of the <code>lm</code> object, indicate what quantity is being calculated and match it to the formulas in the slides/textbooks.</p></li>
<li><p>Evaluate the goodness of fit of the model.</p></li>
<li><p>Fit a multiple regression model in <strong>R</strong> including both explanatory variables. Interpret the estimated coefficients.</p></li>
<li><p>Evaluate the goodness of fit of the multiple regression model.</p></li>
<li><p>Obtain a 95% confidence interval for the mean weight loss when hardness is 70 Shore degrees and tensile strength is 180 kg/cm². For the same values, compute a 95% prediction interval for the response.</p></li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>FEV</code> dataset
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Littell et al.&nbsp;(2000) reported a pharmaceutical clinical trial involving <span class="math inline">n = 72</span> patients, randomly assigned to three treatment groups (drug A, drug B, and placebo), with 24 patients per group. The outcome of interest was respiratory function, measured as FEV1 (forced expiratory volume in one second, in liters). The dataset <code>FEV.dat</code> is <a href="../data/FEV.dat">available here</a>; the first six observations are shown below.</p>
<p>In this analysis, let <span class="math inline">y</span> denote the FEV1 value after one hour of treatment (variable <code>fev1</code> in the dataset). Define</p>
<ul>
<li><span class="math inline">x_1</span>: baseline FEV1 measurement prior to treatment (<code>base</code>),<br>
</li>
<li><span class="math inline">x_2</span>: treatment group (categorical variable <code>drug</code> with labels <code>a</code>, <code>b</code>, <code>p</code>).</li>
</ul>
<p><a href="../data/FEV.dat">Download the data</a> and then:</p>
<ol type="a">
<li><p>Fit linear models for <span class="math inline">y</span> using the following sets of predictors: (i) <span class="math inline">x_1</span> only, (ii) <span class="math inline">x_2</span> only, (iii) both <span class="math inline">x_1</span> and <span class="math inline">x_2</span></p></li>
<li><p>Test to see whether the interaction terms are needed.</p></li>
<li><p>Check the underlying assumptions of the fitted models. If they are violated, propose a solution.</p></li>
<li><p>For each model, <span class="blue">interpret</span> the estimated parameters.</p></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">patient</th>
<th style="text-align: right;">base</th>
<th style="text-align: right;">fev1</th>
<th style="text-align: right;">fev2</th>
<th style="text-align: right;">fev3</th>
<th style="text-align: right;">fev4</th>
<th style="text-align: right;">fev5</th>
<th style="text-align: right;">fev6</th>
<th style="text-align: right;">fev7</th>
<th style="text-align: right;">fev8</th>
<th style="text-align: left;">drug</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.46</td>
<td style="text-align: right;">2.68</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">2.30</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">2.33</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.50</td>
<td style="text-align: right;">3.95</td>
<td style="text-align: right;">3.65</td>
<td style="text-align: right;">2.93</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">3.04</td>
<td style="text-align: right;">3.37</td>
<td style="text-align: right;">3.14</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.96</td>
<td style="text-align: right;">2.28</td>
<td style="text-align: right;">2.34</td>
<td style="text-align: right;">2.29</td>
<td style="text-align: right;">2.43</td>
<td style="text-align: right;">2.06</td>
<td style="text-align: right;">2.18</td>
<td style="text-align: right;">2.28</td>
<td style="text-align: right;">2.29</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">3.44</td>
<td style="text-align: right;">4.08</td>
<td style="text-align: right;">3.87</td>
<td style="text-align: right;">3.79</td>
<td style="text-align: right;">3.30</td>
<td style="text-align: right;">3.80</td>
<td style="text-align: right;">3.24</td>
<td style="text-align: right;">2.98</td>
<td style="text-align: right;">2.91</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">4.09</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">3.54</td>
<td style="text-align: right;">3.35</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">3.23</td>
<td style="text-align: right;">3.46</td>
<td style="text-align: right;">3.27</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">2.36</td>
<td style="text-align: right;">3.79</td>
<td style="text-align: right;">3.97</td>
<td style="text-align: right;">3.78</td>
<td style="text-align: right;">3.69</td>
<td style="text-align: right;">3.31</td>
<td style="text-align: right;">2.83</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: left;">a</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>Anorexia</code> dataset
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For <span class="math inline">n = 72</span> young girls diagnosed with anorexia, the dataset <code>Anorexia.dat</code> <a href="../data/Anorexia.dat">available here</a> records their body weights (in lbs) before and after an experimental treatment period. The data format is illustrated below. During the study, the participants were randomly assigned to one of three <code>therapy</code> groups:</p>
<ul>
<li>Control group: received the standard therapy (label <code>c</code>),<br>
</li>
<li>Family therapy (label <code>f</code>),<br>
</li>
<li>Cognitive behavioral therapy (label <code>b</code>).</li>
</ul>
<p><a href="../data/Anorexia.dat">Download the data</a> and</p>
<ol type="a">
<li><p>Fit a linear model where the outcome is the <span class="blue">post-treatment weight</span> and the predictors are the <span class="orange">baseline weight</span> and the <span class="orange">therapy group</span></p></li>
<li><p>Check the underlying assumptions of the fitted models. If they are violated, propose a solution.</p></li>
<li><p><span class="blue">Interpret</span> the estimated parameters of the model.</p></li>
<li><p>Convert the weights to kilograms (<span class="math inline">1\ \text{lb} = 0.453592\ \text{kg}</span>), repeat the analysis, and discuss whether the results change and why.</p></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">subj</th>
<th style="text-align: left;">therapy</th>
<th style="text-align: right;">before</th>
<th style="text-align: right;">after</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: right;">80.5</td>
<td style="text-align: right;">82.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">b</td>
<td style="text-align: right;">84.9</td>
<td style="text-align: right;">85.6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">b</td>
<td style="text-align: right;">81.5</td>
<td style="text-align: right;">81.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">b</td>
<td style="text-align: right;">82.6</td>
<td style="text-align: right;">81.9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">b</td>
<td style="text-align: right;">79.9</td>
<td style="text-align: right;">76.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">b</td>
<td style="text-align: right;">88.7</td>
<td style="text-align: right;">103.6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="theoretical" class="level2">
<h2 class="anchored" data-anchor-id="theoretical">Theoretical</h2>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise A
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Prove that the variance-stabilizing transform for gamma random variables <span class="math inline">Y_i\sim \text{Gamma}(\alpha, \beta_i)</span> with mean <span class="math inline">\mu_i = \alpha/\beta_i</span> and variance <span class="math inline">\alpha/\beta_i^2</span>, is the logarithm <span class="math inline">g(Y_i) = \log(Y_i)</span>.</p>
<p><span class="blue">Hint</span>: use the fact that if <span class="math inline">Y_i \sim \text{Gamma}(\alpha, \beta_i)</span> with mean <span class="math inline">\mu_i = \alpha/\beta_i</span> and variance <span class="math inline">\alpha/\beta_i^2</span>, then for large values of <span class="math inline">\alpha</span> we have the approximation <span class="math inline">Y_i \; \dot{\sim}\;\text{N}(\alpha/\beta_i, \alpha/\beta_i^2)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise B
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the linear model <span class="math inline">\mathbb{E}(Y_i) = \beta_1 + \beta_2 x_i</span>, suppose that instead of observing <span class="math inline">x_i</span> we observe <span class="math inline">x_i^* = x_i + u_i</span>, where <span class="math inline">u_i</span> is independent of <span class="math inline">x_i</span> for all <span class="math inline">i</span>, with <span class="math inline">\mathbb{E}(u_i) = \mu_u</span> and <span class="math inline">\text{var}(u_i) = \sigma^2_u</span>. Analyze the expected impact of this <span class="orange">measurement error</span> on <span class="math inline">\hat{\beta}_1</span> and the residuals <span class="math inline">\bm{r}</span>. What does it happen if <span class="math inline">\mu_u = 0</span>?</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise C
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In some applications, such as regressing annual income on the number of years of education, the variance of <span class="math inline">Y_i</span> tends to be larger at higher values of <span class="math inline">x_i &gt; 0</span>. Consider the model <span class="math inline">\mathbb{E}(Y_i) = \beta_1 x_i</span>, assuming <span class="math inline">\text{var}(Y_i) = \sigma^2 x_i</span> for unknown <span class="math inline">\sigma^2</span>.</p>
<ol type="a">
<li><p>Show that the weighted least squares estimator minimizes <span class="math inline">\sum_{i=1}^n(y_i - \beta x_i)^2/x_i</span> (i.e., giving more weight to observation with smaller <span class="math inline">x_i</span>) and has <span class="math inline">\hat{\beta}_\text{wls} = \bar{y}/\bar{x}</span>, with <span class="math inline">\text{var}(\hat{\beta}_\text{wls}) = \sigma^2 / \sum_{i=1}^n x_i</span>.</p></li>
<li><p>Show that the ordinary least squares estimator is <span class="math inline">\hat{\beta} = (\sum_{i=1}^n x_i y_i) / \sum_{i=1}^n x_i^2</span> and has <span class="math inline">\text{var}(\hat{\beta}) = \sigma^2 (\sum_{i=1}^n x_i^3) /(\sum_{i=1}^n x_i^2)^2</span>.</p></li>
<li><p>Show that <span class="math inline">\text{var}(\hat{\beta}) \ge \text{var}(\hat{\beta}_\text{wls})</span>.</p></li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise D
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Suppose the normal linear model <span class="math inline">\bm{Y} = \bm{X}\beta + z\gamma + \bm{\epsilon}</span>, with <span class="math inline">\bm{X}</span> an <span class="math inline">n \times p</span> matrix (rank <span class="math inline">p&lt;n</span>), <span class="math inline">\bm{z}</span> an <span class="math inline">n \times 1</span> vector, and <span class="math inline">\bm{\epsilon} \sim \text{N}_n(0,\sigma^2 I_n)</span>. We instead fit <span class="math inline">\bm{Y} = \bm{X}\beta + \bm{\varepsilon}</span>, with <span class="math display">
\hat{\beta} = (\bm{X}^T \bm{X})^{-1}\bm{X}^T \bm{y}, \qquad \bm{r} = (I_n - \bm{H})\bm{y}.
</span></p>
<ol type="a">
<li><p>Show that <span class="math display">
\bm{r} = (I_n - \bm{H})\bm{z}\gamma + (I_n - \bm{H})\bm{\epsilon}</span> so <span class="math inline">\mathbb{E}(\bm{r}) = (I_n - \bm{H})\bm{z}\gamma</span>. What if <span class="math inline">\bm{z}</span> lies in the column space of <span class="math inline">\bm{X}</span>? What if <span class="math inline">\bm{z}</span> is orthogonal to the column space of <span class="math inline">\bm{X}</span>?</p></li>
<li><p>Explain why the <span class="blue">added-variable plot</span> (residuals <span class="math inline">\bm{r}</span> vs.&nbsp;residuals from regressing <span class="math inline">\bm{z}</span> on <span class="math inline">\bm{X}</span>) helps assess whether to include <span class="math inline">\bm{z}</span>.</p></li>
<li><p>Using the plots in the figure below, referring to the same set of data, comment on the results and suggest how to modify the model.</p></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exe_A_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exe_A_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<script src="exe_A_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>